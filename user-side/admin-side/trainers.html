<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trainers Management - EduMentor Pro Admin</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/admin-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="admin-body">
    <!-- Admin Header -->
    <header class="admin-header">
        <div class="admin-header-content">
            <div class="admin-brand">
                <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle menu">
                    <i class="fas fa-bars"></i>
                </button>
                <i class="fas fa-shield-alt"></i>
                <span class="brand-text">EduMentor Pro</span>
                <span class="admin-badge">Admin</span>
            </div>
            
            <div class="header-search">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search trainers..." id="globalSearch">
                </div>
            </div>
            
            <div class="header-actions">
                <button class="notification-btn" title="Notifications">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </button>
                
                <div class="admin-profile">
                    <img src="../assets/images/admin-avatar.jpg" alt="Admin" class="admin-avatar">
                    <div class="admin-details">
                        <span class="admin-name">John Admin</span>
                        <span class="admin-role">Super Admin</span>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Admin Layout -->
    <div class="admin-layout">
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <h3>Main</h3>
                    <ul>
                        <li><a href="index.html" class="nav-link">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                        </a></li>
                        <li><a href="analytics.html" class="nav-link">
                            <i class="fas fa-chart-line"></i>
                            <span>Analytics</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>Content Management</h3>
                    <ul>
                        <li><a href="courses.html" class="nav-link">
                            <i class="fas fa-book"></i>
                            <span>Courses</span>
                            <span class="nav-badge">24</span>
                        </a></li>
                        <li><a href="trainers.html" class="nav-link active">
                            <i class="fas fa-chalkboard-teacher"></i>
                            <span>Trainers</span>
                            <span class="nav-badge">12</span>
                        </a></li>
                        <li><a href="blog.html" class="nav-link">
                            <i class="fas fa-blog"></i>
                            <span>Blog Posts</span>
                        </a></li>
                        <li><a href="resources.html" class="nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Resources</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>User Management</h3>
                    <ul>
                        <li><a href="users.html" class="nav-link">
                            <i class="fas fa-users"></i>
                            <span>Users</span>
                            <span class="nav-badge">1.2K</span>
                        </a></li>
                        <li><a href="roles.html" class="nav-link">
                            <i class="fas fa-user-shield"></i>
                            <span>Roles & Permissions</span>
                        </a></li>
                        <li><a href="registrations.html" class="nav-link">
                            <i class="fas fa-user-plus"></i>
                            <span>Registrations</span>
                            <span class="nav-badge new">5</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>Learning Management</h3>
                    <ul>
                        <li><a href="enrollments.html" class="nav-link">
                            <i class="fas fa-graduation-cap"></i>
                            <span>Enrollments</span>
                        </a></li>
                        <li><a href="certifications.html" class="nav-link">
                            <i class="fas fa-certificate"></i>
                            <span>Certifications</span>
                        </a></li>
                        <li><a href="progress.html" class="nav-link">
                            <i class="fas fa-tasks"></i>
                            <span>Progress Tracking</span>
                        </a></li>
                        <li><a href="assessments.html" class="nav-link">
                            <i class="fas fa-clipboard-check"></i>
                            <span>Assessments</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>Community</h3>
                    <ul>
                        <li><a href="forum.html" class="nav-link">
                            <i class="fas fa-comments"></i>
                            <span>Forum Management</span>
                        </a></li>
                        <li><a href="discussions.html" class="nav-link">
                            <i class="fas fa-comment-dots"></i>
                            <span>Discussions</span>
                        </a></li>
                        <li><a href="moderation.html" class="nav-link">
                            <i class="fas fa-eye"></i>
                            <span>Content Moderation</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>System</h3>
                    <ul>
                        <li><a href="settings.html" class="nav-link">
                            <i class="fas fa-cogs"></i>
                            <span>Settings</span>
                        </a></li>
                        <li><a href="backups.html" class="nav-link">
                            <i class="fas fa-database"></i>
                            <span>Backups</span>
                        </a></li>
                        <li><a href="logs.html" class="nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>System Logs</span>
                        </a></li>
                        <li><a href="maintenance.html" class="nav-link">
                            <i class="fas fa-tools"></i>
                            <span>Maintenance</span>
                        </a></li>
                    </ul>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <a href="../user-side/index.html" class="btn btn-outline btn-sm">
                    <i class="fas fa-external-link-alt"></i> View Site
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <div class="page-header">
                <div class="page-title">
                    <h1>Trainers Management</h1>
                    <p>Manage instructor profiles, qualifications, and performance</p>
                </div>
                
                <div class="page-actions">
                    <button class="btn btn-outline">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="btn btn-primary" onclick="openAddTrainerModal()">
                        <i class="fas fa-plus"></i> Add Trainer
                    </button>
                </div>
            </div>

            <!-- Trainer Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-chalkboard-teacher"></i>
                    </div>
                    <div class="stat-details">
                        <h3>24</h3>
                        <p>Total Trainers</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="stat-details">
                        <h3>4.8</h3>
                        <p>Avg Rating</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-details">
                        <h3>18</h3>
                        <p>Active Trainers</p>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-details">
                        <h3>6</h3>
                        <p>Pending Approval</p>
                    </div>
                </div>
            </div>

            <!-- Trainers Table -->
            <div class="content-card">
                <div class="card-header">
                    <h3>All Trainers</h3>
                    
                    <div class="filters">
                        <div class="filter-group">
                            <select class="form-control" aria-label="Filter by status">
                                <option value="">All Status</option>
                                <option value="active">Active</option>
                                <option value="pending">Pending</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <select class="form-control" aria-label="Filter by specialization">
                                <option value="">All Specializations</option>
                                <option value="web-dev">Web Development</option>
                                <option value="mobile-dev">Mobile Development</option>
                                <option value="ui-ux">UI/UX Design</option>
                                <option value="data-science">Data Science</option>
                                <option value="cybersecurity">Cybersecurity</option>
                            </select>
                        </div>
                        
                        <div class="search-group">
                            <i class="fas fa-search"></i>
                            <input type="text" class="form-control" placeholder="Search trainers...">
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>
                                    <input type="checkbox" id="selectAll">
                                </th>
                                <th>Trainer</th>
                                <th>Specialization</th>
                                <th>Experience</th>
                                <th>Courses</th>
                                <th>Students</th>
                                <th>Rating</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="trainersTableBody">
                            <!-- Trainers will be loaded dynamically by JavaScript -->

                        </tbody>
                    </table>
                </div>

                <div class="table-footer">
                    <div class="pagination-info">
                        Showing 1-4 of 24 trainers
                    </div>
                    <div class="pagination">
                        <button class="pagination-btn" disabled>
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="pagination-pages">
                            <button class="pagination-btn active">1</button>
                            <button class="pagination-btn">2</button>
                            <button class="pagination-btn">3</button>
                        </span>
                        <button class="pagination-btn">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Enhanced Add Trainer Modal -->
    <div class="modal" id="addTrainerModal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content enhanced-form">
                <div class="modal-header gradient-header">
                    <div class="header-content">
                        <h3><i class="fas fa-user-plus"></i> Add New Trainer</h3>
                        <p>Create a comprehensive trainer profile</p>
                    </div>
                    <button class="modal-close" onclick="closeAddTrainerModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="modal-body">
                    <form id="addTrainerForm" class="enhanced-form-body">
                        <!-- Basic Information Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4><i class="fas fa-user"></i> Basic Information</h4>
                                <div class="section-divider"></div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-group floating-label">
                                    <input type="text" id="trainerName" class="form-control" placeholder=" " required>
                                    <label for="trainerName">Full Name *</label>
                                    <i class="form-icon fas fa-user"></i>
                                </div>
                                
                                <div class="form-group floating-label">
                                    <input type="email" id="trainerEmail" class="form-control" placeholder=" " required>
                                    <label for="trainerEmail">Email Address *</label>
                                    <i class="form-icon fas fa-envelope"></i>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-group floating-label">
                                    <input type="tel" id="trainerPhone" class="form-control" placeholder=" ">
                                    <label for="trainerPhone">Phone Number</label>
                                    <i class="form-icon fas fa-phone"></i>
                                </div>
                                
                                <div class="form-group floating-label">
                                    <select id="trainerSpecialization" class="form-control" required>
                                        <option value="">Select specialization</option>
                                        <option value="web-dev">Web Development</option>
                                        <option value="mobile-dev">Mobile Development</option>
                                        <option value="ui-ux">UI/UX Design</option>
                                        <option value="data-science">Data Science</option>
                                        <option value="cybersecurity">Cybersecurity</option>
                                        <option value="cloud-computing">Cloud Computing</option>
                                        <option value="ai-ml">AI & Machine Learning</option>
                                        <option value="blockchain">Blockchain</option>
                                        <option value="devops">DevOps</option>
                                        <option value="other">Other</option>
                                    </select>
                                    <label for="trainerSpecialization">Specialization *</label>
                                    <i class="form-icon fas fa-code"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Professional Details Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4><i class="fas fa-briefcase"></i> Professional Details</h4>
                                <div class="section-divider"></div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-group floating-label">
                                    <input type="number" id="trainerExperience" class="form-control" min="0" max="50" placeholder=" ">
                                    <label for="trainerExperience">Years of Experience</label>
                                    <i class="form-icon fas fa-calendar-alt"></i>
                                </div>
                                
                                <div class="form-group floating-label">
                                    <input type="text" id="trainerCompany" class="form-control" placeholder=" ">
                                    <label for="trainerCompany">Current Company</label>
                                    <i class="form-icon fas fa-building"></i>
                                </div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-group floating-label">
                                    <input type="text" id="trainerEducation" class="form-control" placeholder=" ">
                                    <label for="trainerEducation">Education</label>
                                    <i class="form-icon fas fa-graduation-cap"></i>
                                </div>
                                
                                <div class="form-group floating-label">
                                    <input type="text" id="trainerCertifications" class="form-control" placeholder=" ">
                                    <label for="trainerCertifications">Certifications</label>
                                    <i class="form-icon fas fa-certificate"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Profile Details Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4><i class="fas fa-info-circle"></i> Profile Details</h4>
                                <div class="section-divider"></div>
                            </div>
                            
                            <div class="form-group floating-label">
                                <textarea id="trainerBio" class="form-control" rows="4" placeholder=" "></textarea>
                                <label for="trainerBio">Biography & Qualifications</label>
                                <i class="form-icon fas fa-edit"></i>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-group floating-label">
                                    <select id="trainerStatus" class="form-control" required>
                                        <option value="active">Active</option>
                                        <option value="pending">Pending Approval</option>
                                        <option value="inactive">Inactive</option>
                                    </select>
                                    <label for="trainerStatus">Status *</label>
                                    <i class="form-icon fas fa-toggle-on"></i>
                                </div>
                                
                                <div class="form-group floating-label">
                                    <input type="url" id="trainerLinkedIn" class="form-control" placeholder=" ">
                                    <label for="trainerLinkedIn">LinkedIn Profile</label>
                                    <i class="form-icon fab fa-linkedin"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Profile Photo Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4><i class="fas fa-camera"></i> Profile Photo</h4>
                                <div class="section-divider"></div>
                            </div>
                            
                            <div class="photo-upload-section">
                                <div class="photo-preview-container">
                                    <div class="photo-preview" id="photoPreview">
                                        <i class="fas fa-user-circle"></i>
                                        <span>No photo selected</span>
                                    </div>
                                    <div class="photo-controls">
                                        <label for="trainerPhoto" class="btn btn-outline-primary">
                                            <i class="fas fa-upload"></i> Choose Photo
                                        </label>
                                        <button type="button" class="btn btn-outline-danger" id="removePhoto" style="display: none;">
                                            <i class="fas fa-trash"></i> Remove
                                        </button>
                                    </div>
                                </div>
                                <input type="file" id="trainerPhoto" accept="image/*" style="display: none;">
                                <div class="photo-guidelines">
                                    <small class="text-muted">
                                        <i class="fas fa-info-circle"></i>
                                        Recommended: Square image, 400x400px minimum, JPG or PNG format
                                    </small>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                
                <div class="modal-footer enhanced-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeAddTrainerModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button type="button" class="btn btn-primary" id="submitTrainerBtn" onclick="if(window.trainerManager) { const form = document.getElementById('addTrainerForm'); const event = new Event('submit', {bubbles: true, cancelable: true}); form.dispatchEvent(event); }">
                        <i class="fas fa-save"></i> Add Trainer
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../assets/js/main.js"></script>
    <script>
        // Trainers Management System
        class TrainerManager {
            constructor() {
                this.trainers = this.loadTrainers();
                this.nextId = this.getNextId();
                this.initializeEventListeners();
                this.displayTrainers();
            }

            loadTrainers() {
                const savedTrainers = localStorage.getItem('edumentor_trainers');
                if (savedTrainers) {
                    return JSON.parse(savedTrainers);
                }
                
                // Default sample data
                return [
                    {
                        id: 1,
                        name: 'Dr. Sarah Johnson',
                        email: 'sarah.johnson@edumentor.com',
                        phone: '+1 (555) 123-4567',
                        specialization: 'Mathematics Education',
                        qualification: 'PhD in Mathematics',
                        experience: '8 years',
                        rating: 4.9,
                        coursesCount: 15,
                        studentsCount: 324,
                        status: 'active',
                        joinDate: '2023-01-15',
                        bio: 'Experienced mathematics educator with a passion for innovative teaching methods.',
                        profileImage: '../assets/images/trainer1.jpg'
                    },
                    {
                        id: 2,
                        name: 'Prof. Michael Chen',
                        email: 'michael.chen@edumentor.com',
                        phone: '+1 (555) 234-5678',
                        specialization: 'Science Education',
                        qualification: 'PhD in Physics',
                        experience: '12 years',
                        rating: 4.8,
                        coursesCount: 22,
                        studentsCount: 487,
                        status: 'active',
                        joinDate: '2022-09-10',
                        bio: 'Science education specialist focusing on hands-on learning approaches.',
                        profileImage: '../assets/images/trainer2.jpg'
                    },
                    {
                        id: 3,
                        name: 'Dr. Emily Rodriguez',
                        email: 'emily.rodriguez@edumentor.com',
                        phone: '+1 (555) 345-6789',
                        specialization: 'Language Arts',
                        qualification: 'PhD in English Literature',
                        experience: '6 years',
                        rating: 4.7,
                        coursesCount: 18,
                        studentsCount: 298,
                        status: 'active',
                        joinDate: '2023-03-22',
                        bio: 'Language arts expert with expertise in creative writing and literature.',
                        profileImage: '../assets/images/trainer3.jpg'
                    }
                ];
            }

            saveTrainers() {
                localStorage.setItem('edumentor_trainers', JSON.stringify(this.trainers));
            }

            getNextId() {
                const maxId = this.trainers.length > 0 ? Math.max(...this.trainers.map(t => t.id)) : 0;
                return maxId + 1;
            }

            initializeEventListeners() {
                // Add trainer form submission
                const addForm = document.getElementById('addTrainerForm');
                if (addForm) {
                    addForm.addEventListener('submit', (e) => this.handleAddTrainer(e));
                }

                // Search functionality
                const searchInput = document.getElementById('globalSearch');
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => this.searchTrainers(e.target.value));
                }

                // Filter functionality
                const statusFilter = document.getElementById('statusFilter');
                if (statusFilter) {
                    statusFilter.addEventListener('change', (e) => this.filterTrainers(e.target.value));
                }
            }

            displayTrainers(trainersToShow = null) {
                const trainers = trainersToShow || this.trainers;
                const tbody = document.getElementById('trainersTableBody');
                
                console.log('Displaying trainers:', trainers.length, 'trainers');
                
                if (!tbody) {
                    console.error('trainersTableBody element not found!');
                    return;
                }

                tbody.innerHTML = '';

                trainers.forEach(trainer => {
                    const row = this.createTrainerRow(trainer);
                    tbody.appendChild(row);
                });

                this.updateStats();
                console.log('Trainers displayed successfully');
            }

            createTrainerRow(trainer) {
                const row = document.createElement('tr');
                
                const statusClass = trainer.status === 'active' ? 'success' : 
                                  trainer.status === 'pending' ? 'warning' : 'danger';
                
                row.innerHTML = `
                    <td>
                        <input type="checkbox" class="row-checkbox" value="${trainer.id}">
                    </td>
                    <td>
                        <div class="trainer-info">
                            <img src="${trainer.profileImage || '../assets/images/default-avatar.jpg'}" 
                                 alt="${trainer.name}" class="trainer-avatar">
                            <div>
                                <div class="trainer-name">${trainer.name}</div>
                                <div class="trainer-email">${trainer.email}</div>
                            </div>
                        </div>
                    </td>
                    <td>${trainer.specialization}</td>
                    <td>${trainer.qualification}</td>
                    <td>${trainer.experience}</td>
                    <td>
                        <div class="rating">
                            <span class="rating-value">${trainer.rating}</span>
                            <div class="stars">
                                ${this.generateStars(trainer.rating)}
                            </div>
                        </div>
                    </td>
                    <td>${trainer.coursesCount}</td>
                    <td>${trainer.studentsCount}</td>
                    <td>
                        <span class="status-badge status-${statusClass}">${trainer.status}</span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-action btn-view" onclick="trainerManager.viewTrainer(${trainer.id})" 
                                    title="View Details">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn-action btn-edit" onclick="trainerManager.editTrainer(${trainer.id})" 
                                    title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-action btn-delete" onclick="trainerManager.deleteTrainer(${trainer.id})" 
                                    title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;

                return row;
            }

            generateStars(rating) {
                const fullStars = Math.floor(rating);
                const hasHalfStar = rating % 1 !== 0;
                let stars = '';

                for (let i = 0; i < fullStars; i++) {
                    stars += '<i class="fas fa-star"></i>';
                }

                if (hasHalfStar) {
                    stars += '<i class="fas fa-star-half-alt"></i>';
                }

                const emptyStars = 5 - Math.ceil(rating);
                for (let i = 0; i < emptyStars; i++) {
                    stars += '<i class="far fa-star"></i>';
                }

                return stars;
            }

            handleAddTrainer(e) {
                e.preventDefault();
                console.log('handleAddTrainer called');
                
                const editId = e.target.dataset.editId;
                
                // Validate required fields
                const name = document.getElementById('trainerName').value.trim();
                const email = document.getElementById('trainerEmail').value.trim();
                const specialization = document.getElementById('trainerSpecialization').value;
                const status = document.getElementById('trainerStatus').value;
                
                if (!name || !email || !specialization || !status) {
                    this.showAlert('Please fill in all required fields', 'error');
                    return;
                }
                
                const trainerData = {
                    name: name,
                    email: email,
                    phone: document.getElementById('trainerPhone').value.trim(),
                    specialization: specialization,
                    qualification: document.getElementById('trainerEducation').value.trim(),
                    experience: document.getElementById('trainerExperience').value || '0',
                    bio: document.getElementById('trainerBio').value.trim(),
                    status: status
                };
                
                console.log('Trainer data:', trainerData);

                if (editId) {
                    // Update existing trainer
                    this.updateTrainer(parseInt(editId), trainerData);
                } else {
                    // Add new trainer
                    const trainer = {
                        id: this.nextId++,
                        ...trainerData,
                        rating: 0,
                        coursesCount: 0,
                        studentsCount: 0,
                        joinDate: new Date().toISOString().split('T')[0],
                        profileImage: '../assets/images/default-avatar.jpg'
                    };

                    this.trainers.push(trainer);
                    this.saveTrainers();
                    this.displayTrainers();
                    this.showAlert('Trainer added successfully!', 'success');
                }
                
                this.closeAddTrainerModal();
                e.target.reset();
            }

            editTrainer(id) {
                const trainer = this.trainers.find(t => t.id === id);
                if (!trainer) return;

                // Populate edit form with trainer data
                document.getElementById('trainerName').value = trainer.name || '';
                document.getElementById('trainerEmail').value = trainer.email || '';
                document.getElementById('trainerPhone').value = trainer.phone || '';
                document.getElementById('trainerSpecialization').value = trainer.specialization || '';
                document.getElementById('trainerEducation').value = trainer.qualification || '';
                document.getElementById('trainerExperience').value = trainer.experience || '';
                document.getElementById('trainerBio').value = trainer.bio || '';
                document.getElementById('trainerStatus').value = trainer.status || 'active';

                // Change modal title and button text
                document.querySelector('#addTrainerModal h3').textContent = 'Edit Trainer';
                document.querySelector('#submitTrainerBtn').innerHTML = '<i class="fas fa-save"></i> Update Trainer';

                // Store the ID for update
                document.getElementById('addTrainerForm').dataset.editId = id;

                this.openAddTrainerModal();
            }

            updateTrainer(id, updatedData) {
                const index = this.trainers.findIndex(t => t.id === id);
                if (index !== -1) {
                    this.trainers[index] = { ...this.trainers[index], ...updatedData };
                    this.saveTrainers();
                    this.displayTrainers();
                    this.showAlert('Trainer updated successfully!', 'success');
                }
            }

            deleteTrainer(id) {
                const trainer = this.trainers.find(t => t.id === id);
                if (!trainer) return;

                if (confirm(`Are you sure you want to delete ${trainer.name}? This action cannot be undone.`)) {
                    this.trainers = this.trainers.filter(t => t.id !== id);
                    this.saveTrainers();
                    this.displayTrainers();
                    this.showAlert('Trainer deleted successfully!', 'success');
                }
            }

            viewTrainer(id) {
                const trainer = this.trainers.find(t => t.id === id);
                if (!trainer) return;

                // Create and show trainer details modal
                this.showTrainerDetails(trainer);
            }

            showTrainerDetails(trainer) {
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.innerHTML = `
                    <div class="modal-content trainer-details-modal">
                        <div class="modal-header">
                            <h2><i class="fas fa-user"></i> Trainer Details</h2>
                            <button type="button" class="close-modal" onclick="this.closest('.modal').remove()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="trainer-profile">
                                <img src="${trainer.profileImage}" alt="${trainer.name}" class="profile-image">
                                <div class="profile-info">
                                    <h3>${trainer.name}</h3>
                                    <p class="specialization">${trainer.specialization}</p>
                                    <div class="rating-display">
                                        ${this.generateStars(trainer.rating)} 
                                        <span>(${trainer.rating}/5.0)</span>
                                    </div>
                                </div>
                            </div>
                            <div class="trainer-stats">
                                <div class="stat-item">
                                    <i class="fas fa-book"></i>
                                    <span>${trainer.coursesCount} Courses</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-users"></i>
                                    <span>${trainer.studentsCount} Students</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-calendar"></i>
                                    <span>Joined ${trainer.joinDate}</span>
                                </div>
                            </div>
                            <div class="trainer-details">
                                <div class="detail-row">
                                    <label>Email:</label>
                                    <span>${trainer.email}</span>
                                </div>
                                <div class="detail-row">
                                    <label>Phone:</label>
                                    <span>${trainer.phone}</span>
                                </div>
                                <div class="detail-row">
                                    <label>Qualification:</label>
                                    <span>${trainer.qualification}</span>
                                </div>
                                <div class="detail-row">
                                    <label>Experience:</label>
                                    <span>${trainer.experience}</span>
                                </div>
                                <div class="detail-row">
                                    <label>Status:</label>
                                    <span class="status-badge status-${trainer.status === 'active' ? 'success' : 'warning'}">${trainer.status}</span>
                                </div>
                                <div class="detail-row">
                                    <label>Bio:</label>
                                    <p>${trainer.bio}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                document.body.appendChild(modal);
                modal.style.display = 'flex';
            }

            searchTrainers(query) {
                if (!query.trim()) {
                    this.displayTrainers();
                    return;
                }

                const filteredTrainers = this.trainers.filter(trainer =>
                    trainer.name.toLowerCase().includes(query.toLowerCase()) ||
                    trainer.email.toLowerCase().includes(query.toLowerCase()) ||
                    trainer.specialization.toLowerCase().includes(query.toLowerCase()) ||
                    trainer.qualification.toLowerCase().includes(query.toLowerCase())
                );

                this.displayTrainers(filteredTrainers);
            }

            filterTrainers(status) {
                if (status === 'all') {
                    this.displayTrainers();
                    return;
                }

                const filteredTrainers = this.trainers.filter(trainer => trainer.status === status);
                this.displayTrainers(filteredTrainers);
            }

            updateStats() {
                // Update stats in dashboard
                const activeTrainers = this.trainers.filter(t => t.status === 'active').length;
                const totalTrainers = this.trainers.length;
                const avgRating = this.trainers.reduce((sum, t) => sum + t.rating, 0) / this.trainers.length;
                
                // Update any stat displays if they exist
                const statElements = document.querySelectorAll('.trainer-count');
                statElements.forEach(el => {
                    el.textContent = totalTrainers;
                });
                
                // Update other stats if elements exist
                const activeElements = document.querySelectorAll('.active-trainers-count');
                activeElements.forEach(el => {
                    el.textContent = activeTrainers;
                });
                
                const ratingElements = document.querySelectorAll('.avg-rating');
                ratingElements.forEach(el => {
                    el.textContent = avgRating.toFixed(1);
                });
            }

            // Bulk operations
            deleteSelectedTrainers() {
                const selectedCheckboxes = document.querySelectorAll('.row-checkbox:checked');
                const selectedIds = Array.from(selectedCheckboxes).map(cb => parseInt(cb.value));
                
                if (selectedIds.length === 0) {
                    this.showAlert('Please select trainers to delete.', 'warning');
                    return;
                }
                
                if (confirm(`Are you sure you want to delete ${selectedIds.length} selected trainer(s)? This action cannot be undone.`)) {
                    this.trainers = this.trainers.filter(t => !selectedIds.includes(t.id));
                    this.saveTrainers();
                    this.displayTrainers();
                    this.showAlert(`${selectedIds.length} trainer(s) deleted successfully!`, 'success');
                    
                    // Uncheck select all
                    const selectAll = document.getElementById('selectAll');
                    if (selectAll) selectAll.checked = false;
                }
            }

            changeStatusBulk(newStatus) {
                const selectedCheckboxes = document.querySelectorAll('.row-checkbox:checked');
                const selectedIds = Array.from(selectedCheckboxes).map(cb => parseInt(cb.value));
                
                if (selectedIds.length === 0) {
                    this.showAlert('Please select trainers to update status.', 'warning');
                    return;
                }
                
                selectedIds.forEach(id => {
                    const trainer = this.trainers.find(t => t.id === id);
                    if (trainer) {
                        trainer.status = newStatus;
                    }
                });
                
                this.saveTrainers();
                this.displayTrainers();
                this.showAlert(`${selectedIds.length} trainer(s) status updated to ${newStatus}!`, 'success');
            }

            // Export functionality
            exportTrainers() {
                const csvContent = this.trainersToCSV();
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `trainers_export_${new Date().toISOString().split('T')[0]}.csv`;
                a.click();
                window.URL.revokeObjectURL(url);
            }

            trainersToCSV() {
                const headers = ['ID', 'Name', 'Email', 'Phone', 'Specialization', 'Qualification', 'Experience', 'Rating', 'Status', 'Join Date'];
                const rows = this.trainers.map(trainer => [
                    trainer.id,
                    trainer.name,
                    trainer.email,
                    trainer.phone,
                    trainer.specialization,
                    trainer.qualification,
                    trainer.experience,
                    trainer.rating,
                    trainer.status,
                    trainer.joinDate
                ]);
                
                return [headers, ...rows].map(row => row.join(',')).join('\n');
            }

            showAlert(message, type = 'info') {
                const alert = document.createElement('div');
                alert.className = `alert alert-${type}`;
                alert.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                    ${message}
                `;

                document.body.appendChild(alert);
                
                setTimeout(() => {
                    alert.remove();
                }, 3000);
            }

            // Modal Functions
            openAddTrainerModal() {
                console.log('TrainerManager.openAddTrainerModal called');
                const modal = document.getElementById('addTrainerModal');
                console.log('Modal element found:', !!modal);
                
                if (modal) {
                    modal.style.display = 'flex';
                    modal.style.position = 'fixed';
                    modal.style.top = '0';
                    modal.style.left = '0';
                    modal.style.width = '100%';
                    modal.style.height = '100%';
                    modal.style.backgroundColor = 'rgba(0,0,0,0.5)';
                    modal.style.zIndex = '9999';
                    modal.style.justifyContent = 'center';
                    modal.style.alignItems = 'center';
                    console.log('Modal styles applied and displayed');
                } else {
                    console.error('Modal element not found!');
                }
            }

            closeAddTrainerModal() {
                document.getElementById('addTrainerModal').style.display = 'none';
                
                // Reset form and modal state
                document.getElementById('addTrainerForm').reset();
                document.querySelector('#addTrainerModal h3').textContent = 'Add New Trainer';
                document.querySelector('#submitTrainerBtn').innerHTML = '<i class="fas fa-save"></i> Add Trainer';
                delete document.getElementById('addTrainerForm').dataset.editId;
            }
        }

        // Modal Functions (Global)
        function openAddTrainerModal() {
            console.log('openAddTrainerModal called');
            console.log('window.trainerManager exists:', !!window.trainerManager);
            
            if (window.trainerManager) {
                console.log('Calling trainerManager.openAddTrainerModal()');
                window.trainerManager.openAddTrainerModal();
            } else {
                console.error('TrainerManager not initialized!');
                // Fallback - directly show modal
                const modal = document.getElementById('addTrainerModal');
                if (modal) {
                    modal.style.display = 'flex';
                    console.log('Modal opened directly');
                } else {
                    console.error('Modal element not found!');
                }
            }
        }

        function closeAddTrainerModal() {
            if (window.trainerManager) {
                window.trainerManager.closeAddTrainerModal();
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Initializing Trainers Management System...');
            
            // Initialize trainer manager
            window.trainerManager = new TrainerManager();
            console.log('TrainerManager initialized:', window.trainerManager);

            // Select All Checkbox
            const selectAllCheckbox = document.getElementById('selectAll');
            const rowCheckboxes = document.querySelectorAll('.row-checkbox');

            if (selectAllCheckbox) {
                selectAllCheckbox.addEventListener('change', function() {
                    const currentCheckboxes = document.querySelectorAll('.row-checkbox');
                    currentCheckboxes.forEach(checkbox => {
                        checkbox.checked = this.checked;
                    });
                });
            }

            // Close modal on background click
            const modal = document.getElementById('addTrainerModal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeAddTrainerModal();
                    }
                });
            }

            console.log('Trainers Management System initialized successfully');
        });
    </script>
</body>
</html>
