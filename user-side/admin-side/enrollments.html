<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enrollments - EduMentor Pro Admin</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/admin-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="admin-body">
    <!-- Admin Header -->
    <header class="admin-header">
        <div class="admin-header-content">
            <div class="admin-brand">
                <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle menu">
                    <i class="fas fa-bars"></i>
                </button>
                <i class="fas fa-shield-alt"></i>
                <span class="brand-text">EduMentor Pro</span>
                <span class="admin-badge">Admin</span>
            </div>
            
            <div class="header-search">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search enrollments..." id="globalSearch">
                </div>
            </div>
            
            <div class="header-actions">
                <button class="notification-btn" title="Notifications">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge">3</span>
                </button>
                
                <div class="admin-profile">
                    <img src="../assets/images/admin-avatar.jpg" alt="Admin" class="admin-avatar">
                    <div class="admin-details">
                        <span class="admin-name">John Admin</span>
                        <span class="admin-role">Super Admin</span>
                    </div>
                    <i class="fas fa-chevron-down"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar (same structure as other pages) -->
    <div class="admin-layout">
        <aside class="admin-sidebar">
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <h3>Main</h3>
                    <ul>
                        <li><a href="index.html" class="nav-link">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dashboard</span>
                        </a></li>
                        <li><a href="analytics.html" class="nav-link">
                            <i class="fas fa-chart-line"></i>
                            <span>Analytics</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>Content Management</h3>
                    <ul>
                        <li><a href="courses.html" class="nav-link">
                            <i class="fas fa-book"></i>
                            <span>Courses</span>
                            <span class="nav-badge">24</span>
                        </a></li>
                        <li><a href="trainers.html" class="nav-link">
                            <i class="fas fa-chalkboard-teacher"></i>
                            <span>Trainers</span>
                            <span class="nav-badge">12</span>
                        </a></li>
                        <li><a href="blog.html" class="nav-link">
                            <i class="fas fa-blog"></i>
                            <span>Blog Posts</span>
                        </a></li>
                        <li><a href="resources.html" class="nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>Resources</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>User Management</h3>
                    <ul>
                        <li><a href="users.html" class="nav-link">
                            <i class="fas fa-users"></i>
                            <span>Users</span>
                            <span class="nav-badge">1.2K</span>
                        </a></li>
                        <li><a href="roles.html" class="nav-link">
                            <i class="fas fa-user-shield"></i>
                            <span>Roles & Permissions</span>
                        </a></li>
                        <li><a href="registrations.html" class="nav-link">
                            <i class="fas fa-user-plus"></i>
                            <span>Registrations</span>
                            <span class="nav-badge new">5</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>Learning Management</h3>
                    <ul>
                        <li><a href="enrollments.html" class="nav-link active">
                            <i class="fas fa-graduation-cap"></i>
                            <span>Enrollments</span>
                        </a></li>
                        <li><a href="certifications.html" class="nav-link">
                            <i class="fas fa-certificate"></i>
                            <span>Certifications</span>
                        </a></li>
                        <li><a href="progress.html" class="nav-link">
                            <i class="fas fa-tasks"></i>
                            <span>Progress Tracking</span>
                        </a></li>
                        <li><a href="assessments.html" class="nav-link">
                            <i class="fas fa-clipboard-check"></i>
                            <span>Assessments</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>Community</h3>
                    <ul>
                        <li><a href="forum.html" class="nav-link">
                            <i class="fas fa-comments"></i>
                            <span>Forum Management</span>
                        </a></li>
                        <li><a href="discussions.html" class="nav-link">
                            <i class="fas fa-comment-dots"></i>
                            <span>Discussions</span>
                        </a></li>
                        <li><a href="moderation.html" class="nav-link">
                            <i class="fas fa-eye"></i>
                            <span>Content Moderation</span>
                        </a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <h3>System</h3>
                    <ul>
                        <li><a href="settings.html" class="nav-link">
                            <i class="fas fa-cogs"></i>
                            <span>Settings</span>
                        </a></li>
                        <li><a href="backups.html" class="nav-link">
                            <i class="fas fa-database"></i>
                            <span>Backups</span>
                        </a></li>
                        <li><a href="logs.html" class="nav-link">
                            <i class="fas fa-file-alt"></i>
                            <span>System Logs</span>
                        </a></li>
                        <li><a href="maintenance.html" class="nav-link">
                            <i class="fas fa-tools"></i>
                            <span>Maintenance</span>
                        </a></li>
                    </ul>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <a href="../user-side/index.html" class="btn btn-outline btn-sm">
                    <i class="fas fa-external-link-alt"></i> View Site
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="admin-main">
            <div class="page-header">
                <div class="page-title">
                    <h1>Enrollments Management</h1>
                    <p>Track and manage student course enrollments</p>
                </div>
                
                <div class="page-actions">
                    <button class="btn btn-outline">
                        <i class="fas fa-download"></i> Export Data
                    </button>
                    <button class="btn btn-primary" onclick="openEnrollModal()">
                        <i class="fas fa-plus"></i> Manual Enrollment
                    </button>
                </div>
            </div>

            <!-- Enrollment Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="stat-details">
                        <h3>1,456</h3>
                        <p>Total Enrollments</p>
                        <span class="stat-change positive">+15%</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-details">
                        <h3>892</h3>
                        <p>Active Students</p>
                        <span class="stat-change positive">+8%</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-details">
                        <h3>234</h3>
                        <p>Completed</p>
                        <span class="stat-change positive">+22%</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <div class="stat-details">
                        <h3>47</h3>
                        <p>New Today</p>
                        <span class="stat-change positive">+12%</span>
                    </div>
                </div>
            </div>

            <!-- Quick Overview Cards -->
            <div class="overview-cards">
                <div class="overview-card">
                    <div class="card-header">
                        <h3>Popular Courses</h3>
                        <a href="courses.html" class="view-all">View All</a>
                    </div>
                    <div class="course-list">
                        <div class="course-item">
                            <div class="course-info">
                                <h4>Web Development Fundamentals</h4>
                                <p>456 enrollments</p>
                            </div>
                            <div class="enrollment-trend">
                                <span class="trend-value positive">+24%</span>
                            </div>
                        </div>
                        
                        <div class="course-item">
                            <div class="course-info">
                                <h4>React Development</h4>
                                <p>324 enrollments</p>
                            </div>
                            <div class="enrollment-trend">
                                <span class="trend-value positive">+18%</span>
                            </div>
                        </div>
                        
                        <div class="course-item">
                            <div class="course-info">
                                <h4>UI/UX Design</h4>
                                <p>289 enrollments</p>
                            </div>
                            <div class="enrollment-trend">
                                <span class="trend-value positive">+12%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="overview-card">
                    <div class="card-header">
                        <h3>Recent Enrollments</h3>
                        <select class="form-control period-filter" aria-label="Time period filter">
                            <option>Last 24 hours</option>
                            <option>Last week</option>
                            <option>Last month</option>
                        </select>
                    </div>
                    <div class="recent-enrollments">
                        <div class="enrollment-item">
                            <img src="../assets/images/user1.jpg" alt="Student" class="student-avatar">
                            <div class="enrollment-details">
                                <h4>Sarah Wilson</h4>
                                <p>enrolled in "JavaScript Fundamentals"</p>
                                <span class="enrollment-time">2 hours ago</span>
                            </div>
                        </div>
                        
                        <div class="enrollment-item">
                            <img src="../assets/images/user2.jpg" alt="Student" class="student-avatar">
                            <div class="enrollment-details">
                                <h4>Mike Johnson</h4>
                                <p>enrolled in "React Development"</p>
                                <span class="enrollment-time">4 hours ago</span>
                            </div>
                        </div>
                        
                        <div class="enrollment-item">
                            <img src="../assets/images/user3.jpg" alt="Student" class="student-avatar">
                            <div class="enrollment-details">
                                <h4>Emma Davis</h4>
                                <p>enrolled in "UI/UX Design"</p>
                                <span class="enrollment-time">6 hours ago</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enrollments Table -->
            <div class="content-card">
                <div class="card-header">
                    <h3>All Enrollments</h3>
                    
                    <div class="filters">
                        <div class="filter-group">
                            <select id="statusFilter" class="form-control" aria-label="Filter by status">
                                <option value="all">All Status</option>
                                <option value="active">Active</option>
                                <option value="completed">Completed</option>
                                <option value="pending">Pending</option>
                                <option value="suspended">Suspended</option>
                            </select>
                        </div>
                        
                        <div class="search-group">
                            <i class="fas fa-search"></i>
                            <input type="text" id="globalSearch" class="form-control" placeholder="Search students, courses, instructors...">
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>
                                    <input type="checkbox" id="selectAll" title="Select all enrollments">
                                </th>
                                <th>Student</th>
                                <th>Course</th>
                                <th>Instructor</th>
                                <th>Enrollment Date</th>
                                <th>Progress</th>
                                <th>Status</th>
                                <th>Payment</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="enrollmentsTableBody">
                        </tbody>
                    </table>
                </div>

                <div class="table-footer">
                    <div class="pagination-info">
                        Showing 1-3 of 1,456 enrollments
                    </div>
                    <div class="pagination">
                        <button class="pagination-btn" disabled title="Previous page">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="pagination-pages">
                            <button class="pagination-btn active">1</button>
                            <button class="pagination-btn">2</button>
                            <button class="pagination-btn">3</button>
                            <button class="pagination-btn">...</button>
                            <button class="pagination-btn">15</button>
                        </span>
                        <button class="pagination-btn" title="Next page">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Manual Enrollment Modal -->
    <div class="modal" id="enrollModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Enrollment</h2>
                <button class="modal-close" onclick="closeEnrollModal()" title="Close modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="enrollForm" class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="studentName">Student Name *</label>
                        <input type="text" id="studentName" name="studentName" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="studentEmail">Student Email *</label>
                        <input type="email" id="studentEmail" name="studentEmail" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="courseName">Course Name *</label>
                        <select id="courseName" name="courseName" class="form-control" required>
                            <option value="">Select Course</option>
                            <option value="Modern Teaching Methodologies">Modern Teaching Methodologies</option>
                            <option value="Digital Learning Tools">Digital Learning Tools</option>
                            <option value="Classroom Management">Classroom Management</option>
                            <option value="Assessment Strategies">Assessment Strategies</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="courseCode">Course Code *</label>
                        <input type="text" id="courseCode" name="courseCode" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="instructor">Instructor *</label>
                        <select id="instructor" name="instructor" class="form-control" required>
                            <option value="">Select Instructor</option>
                            <option value="Dr. Michael Brown">Dr. Michael Brown</option>
                            <option value="Prof. Lisa Rodriguez">Prof. Lisa Rodriguez</option>
                            <option value="Dr. James Wilson">Dr. James Wilson</option>
                            <option value="Dr. Sarah Johnson">Dr. Sarah Johnson</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="enrollmentDate">Enrollment Date *</label>
                        <input type="date" id="enrollmentDate" name="enrollmentDate" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="enrollmentStatus">Status *</label>
                        <select id="enrollmentStatus" name="enrollmentStatus" class="form-control" required>
                            <option value="active">Active</option>
                            <option value="pending">Pending</option>
                            <option value="suspended">Suspended</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="paymentStatus">Payment Status *</label>
                        <select id="paymentStatus" name="paymentStatus" class="form-control" required>
                            <option value="pending">Pending</option>
                            <option value="paid">Paid</option>
                            <option value="failed">Failed</option>
                        </select>
                    </div>
                </div>
            </form>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeEnrollModal()">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button type="submit" form="enrollForm" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Enroll Student
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../assets/js/main.js"></script>
    <script>
        // Enrollments Management System
        class EnrollmentManager {
            constructor() {
                this.enrollments = this.loadEnrollments();
                this.nextId = this.getNextId();
                this.initializeEventListeners();
                this.displayEnrollments();
            }

            loadEnrollments() {
                const savedEnrollments = localStorage.getItem('edumentor_enrollments');
                if (savedEnrollments) {
                    return JSON.parse(savedEnrollments);
                }
                
                // Default sample data
                return [
                    {
                        id: 1,
                        studentName: 'Sarah Johnson',
                        studentEmail: 'sarah.j@email.com',
                        courseName: 'Modern Teaching Methodologies',
                        courseCode: 'MTM101',
                        instructor: 'Dr. Michael Brown',
                        enrollmentDate: '2024-01-15',
                        status: 'active',
                        progress: 85,
                        completionDate: null,
                        grade: null,
                        paymentStatus: 'paid'
                    },
                    {
                        id: 2,
                        studentName: 'Michael Chen',
                        studentEmail: 'michael.c@email.com',
                        courseName: 'Digital Learning Tools',
                        courseCode: 'DLT201',
                        instructor: 'Prof. Lisa Rodriguez',
                        enrollmentDate: '2024-02-03',
                        status: 'active',
                        progress: 60,
                        completionDate: null,
                        grade: null,
                        paymentStatus: 'paid'
                    },
                    {
                        id: 3,
                        studentName: 'Emily Davis',
                        studentEmail: 'emily.d@email.com',
                        courseName: 'Classroom Management',
                        courseCode: 'CM301',
                        instructor: 'Dr. James Wilson',
                        enrollmentDate: '2023-12-10',
                        status: 'completed',
                        progress: 100,
                        completionDate: '2024-03-15',
                        grade: 'A',
                        paymentStatus: 'paid'
                    },
                    {
                        id: 4,
                        studentName: 'David Martinez',
                        studentEmail: 'david.m@email.com',
                        courseName: 'Assessment Strategies',
                        courseCode: 'AS401',
                        instructor: 'Dr. Sarah Johnson',
                        enrollmentDate: '2024-03-01',
                        status: 'suspended',
                        progress: 25,
                        completionDate: null,
                        grade: null,
                        paymentStatus: 'pending'
                    }
                ];
            }

            saveEnrollments() {
                localStorage.setItem('edumentor_enrollments', JSON.stringify(this.enrollments));
            }

            getNextId() {
                const maxId = this.enrollments.length > 0 ? Math.max(...this.enrollments.map(e => e.id)) : 0;
                return maxId + 1;
            }

            initializeEventListeners() {
                // Add enrollment form submission
                const enrollForm = document.getElementById('enrollForm');
                if (enrollForm) {
                    enrollForm.addEventListener('submit', (e) => this.handleAddEnrollment(e));
                }

                // Search functionality
                const searchInput = document.getElementById('globalSearch');
                if (searchInput) {
                    searchInput.addEventListener('input', (e) => this.searchEnrollments(e.target.value));
                }

                // Status filter
                const statusFilter = document.getElementById('statusFilter');
                if (statusFilter) {
                    statusFilter.addEventListener('change', (e) => this.filterEnrollments(e.target.value));
                }
            }

            displayEnrollments(enrollmentsToShow = null) {
                const enrollments = enrollmentsToShow || this.enrollments;
                const tbody = document.getElementById('enrollmentsTableBody');
                
                if (!tbody) return;

                tbody.innerHTML = '';

                enrollments.forEach(enrollment => {
                    const row = this.createEnrollmentRow(enrollment);
                    tbody.appendChild(row);
                });

                this.updateStats();
            }

            createEnrollmentRow(enrollment) {
                const row = document.createElement('tr');
                
                const statusClass = enrollment.status === 'active' ? 'success' : 
                                  enrollment.status === 'completed' ? 'info' : 
                                  enrollment.status === 'suspended' ? 'warning' : 'danger';
                
                const paymentClass = enrollment.paymentStatus === 'paid' ? 'success' : 
                                   enrollment.paymentStatus === 'pending' ? 'warning' : 'danger';
                
                row.innerHTML = `
                    <td>
                        <input type="checkbox" class="row-checkbox" value="${enrollment.id}">
                    </td>
                    <td>
                        <div class="student-info">
                            <div class="student-name">${enrollment.studentName}</div>
                            <div class="student-email">${enrollment.studentEmail}</div>
                        </div>
                    </td>
                    <td>
                        <div class="course-info">
                            <div class="course-name">${enrollment.courseName}</div>
                            <div class="course-code">${enrollment.courseCode}</div>
                        </div>
                    </td>
                    <td>${enrollment.instructor}</td>
                    <td>${this.formatDate(enrollment.enrollmentDate)}</td>
                    <td>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${enrollment.progress}%"></div>
                            </div>
                            <span class="progress-text">${enrollment.progress}%</span>
                        </div>
                    </td>
                    <td>
                        <span class="status-badge status-${statusClass}">${enrollment.status}</span>
                    </td>
                    <td>
                        <span class="status-badge status-${paymentClass}">${enrollment.paymentStatus}</span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-action btn-view" onclick="enrollmentManager.viewEnrollment(${enrollment.id})" 
                                    title="View Details">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn-action btn-edit" onclick="enrollmentManager.editEnrollment(${enrollment.id})" 
                                    title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-action btn-delete" onclick="enrollmentManager.deleteEnrollment(${enrollment.id})" 
                                    title="Delete">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;

                return row;
            }

            handleAddEnrollment(e) {
                e.preventDefault();
                
                const formData = new FormData(e.target);
                const enrollment = {
                    id: this.nextId++,
                    studentName: formData.get('studentName'),
                    studentEmail: formData.get('studentEmail'),
                    courseName: formData.get('courseName'),
                    courseCode: formData.get('courseCode'),
                    instructor: formData.get('instructor'),
                    enrollmentDate: formData.get('enrollmentDate'),
                    status: formData.get('enrollmentStatus'),
                    progress: 0,
                    completionDate: null,
                    grade: null,
                    paymentStatus: formData.get('paymentStatus')
                };

                this.enrollments.push(enrollment);
                this.saveEnrollments();
                this.displayEnrollments();
                this.closeEnrollModal();
                
                this.showAlert('Enrollment added successfully!', 'success');
                e.target.reset();
            }

            editEnrollment(id) {
                const enrollment = this.enrollments.find(e => e.id === id);
                if (!enrollment) return;

                // Populate edit form with enrollment data
                document.getElementById('studentName').value = enrollment.studentName;
                document.getElementById('studentEmail').value = enrollment.studentEmail;
                document.getElementById('courseName').value = enrollment.courseName;
                document.getElementById('courseCode').value = enrollment.courseCode;
                document.getElementById('instructor').value = enrollment.instructor;
                document.getElementById('enrollmentDate').value = enrollment.enrollmentDate;
                document.getElementById('enrollmentStatus').value = enrollment.status;
                document.getElementById('paymentStatus').value = enrollment.paymentStatus;

                // Change modal title and button text
                document.querySelector('#enrollModal h2').textContent = 'Edit Enrollment';
                document.querySelector('#enrollModal button[type="submit"]').textContent = 'Update Enrollment';

                // Store the ID for update
                document.getElementById('enrollForm').dataset.editId = id;

                this.openEnrollModal();
            }

            updateEnrollment(id, updatedData) {
                const index = this.enrollments.findIndex(e => e.id === id);
                if (index !== -1) {
                    this.enrollments[index] = { ...this.enrollments[index], ...updatedData };
                    this.saveEnrollments();
                    this.displayEnrollments();
                    this.showAlert('Enrollment updated successfully!', 'success');
                }
            }

            deleteEnrollment(id) {
                const enrollment = this.enrollments.find(e => e.id === id);
                if (!enrollment) return;

                if (confirm(`Are you sure you want to delete the enrollment for ${enrollment.studentName}? This action cannot be undone.`)) {
                    this.enrollments = this.enrollments.filter(e => e.id !== id);
                    this.saveEnrollments();
                    this.displayEnrollments();
                    this.showAlert('Enrollment deleted successfully!', 'success');
                }
            }

            viewEnrollment(id) {
                const enrollment = this.enrollments.find(e => e.id === id);
                if (!enrollment) return;

                this.showEnrollmentDetails(enrollment);
            }

            showEnrollmentDetails(enrollment) {
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.innerHTML = `
                    <div class="modal-content enrollment-details-modal">
                        <div class="modal-header">
                            <h2><i class="fas fa-graduation-cap"></i> Enrollment Details</h2>
                            <button type="button" class="close-modal" onclick="this.closest('.modal').remove()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="enrollment-overview">
                                <div class="student-section">
                                    <h3>Student Information</h3>
                                    <div class="detail-row">
                                        <label>Name:</label>
                                        <span>${enrollment.studentName}</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Email:</label>
                                        <span>${enrollment.studentEmail}</span>
                                    </div>
                                </div>
                                
                                <div class="course-section">
                                    <h3>Course Information</h3>
                                    <div class="detail-row">
                                        <label>Course:</label>
                                        <span>${enrollment.courseName}</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Code:</label>
                                        <span>${enrollment.courseCode}</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Instructor:</label>
                                        <span>${enrollment.instructor}</span>
                                    </div>
                                </div>
                                
                                <div class="progress-section">
                                    <h3>Progress Information</h3>
                                    <div class="detail-row">
                                        <label>Progress:</label>
                                        <div class="progress-display">
                                            <div class="progress-bar">
                                                <div class="progress-fill" style="width: ${enrollment.progress}%"></div>
                                            </div>
                                            <span>${enrollment.progress}%</span>
                                        </div>
                                    </div>
                                    <div class="detail-row">
                                        <label>Status:</label>
                                        <span class="status-badge status-${enrollment.status === 'active' ? 'success' : 'info'}">${enrollment.status}</span>
                                    </div>
                                    <div class="detail-row">
                                        <label>Enrollment Date:</label>
                                        <span>${this.formatDate(enrollment.enrollmentDate)}</span>
                                    </div>
                                    ${enrollment.completionDate ? `
                                        <div class="detail-row">
                                            <label>Completion Date:</label>
                                            <span>${this.formatDate(enrollment.completionDate)}</span>
                                        </div>
                                    ` : ''}
                                    ${enrollment.grade ? `
                                        <div class="detail-row">
                                            <label>Grade:</label>
                                            <span class="grade-display">${enrollment.grade}</span>
                                        </div>
                                    ` : ''}
                                </div>
                                
                                <div class="payment-section">
                                    <h3>Payment Information</h3>
                                    <div class="detail-row">
                                        <label>Payment Status:</label>
                                        <span class="status-badge status-${enrollment.paymentStatus === 'paid' ? 'success' : 'warning'}">${enrollment.paymentStatus}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                document.body.appendChild(modal);
                modal.style.display = 'flex';
            }

            searchEnrollments(query) {
                if (!query.trim()) {
                    this.displayEnrollments();
                    return;
                }

                const filteredEnrollments = this.enrollments.filter(enrollment =>
                    enrollment.studentName.toLowerCase().includes(query.toLowerCase()) ||
                    enrollment.studentEmail.toLowerCase().includes(query.toLowerCase()) ||
                    enrollment.courseName.toLowerCase().includes(query.toLowerCase()) ||
                    enrollment.courseCode.toLowerCase().includes(query.toLowerCase()) ||
                    enrollment.instructor.toLowerCase().includes(query.toLowerCase())
                );

                this.displayEnrollments(filteredEnrollments);
            }

            filterEnrollments(status) {
                if (status === 'all') {
                    this.displayEnrollments();
                    return;
                }

                const filteredEnrollments = this.enrollments.filter(enrollment => enrollment.status === status);
                this.displayEnrollments(filteredEnrollments);
            }

            updateStats() {
                const activeEnrollments = this.enrollments.filter(e => e.status === 'active').length;
                const completedEnrollments = this.enrollments.filter(e => e.status === 'completed').length;
                const totalEnrollments = this.enrollments.length;
                
                // Update any stat displays if they exist
                const statElements = document.querySelectorAll('.enrollment-count');
                statElements.forEach(el => {
                    el.textContent = totalEnrollments;
                });
            }

            formatDate(dateString) {
                return new Date(dateString).toLocaleDateString();
            }

            showAlert(message, type = 'info') {
                const alert = document.createElement('div');
                alert.className = `alert alert-${type}`;
                alert.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                    ${message}
                `;

                document.body.appendChild(alert);
                
                setTimeout(() => {
                    alert.remove();
                }, 3000);
            }

            // Modal Functions
            openEnrollModal() {
                document.getElementById('enrollModal').style.display = 'flex';
            }

            closeEnrollModal() {
                document.getElementById('enrollModal').style.display = 'none';
                
                // Reset form and modal state
                document.getElementById('enrollForm').reset();
                document.querySelector('#enrollModal h2').textContent = 'Add New Enrollment';
                document.querySelector('#enrollModal button[type="submit"]').textContent = 'Enroll Student';
                delete document.getElementById('enrollForm').dataset.editId;
                
                // Set today's date as default
                document.getElementById('enrollmentDate').value = new Date().toISOString().split('T')[0];
            }
        }

        // Modal Functions (Global)
        function openEnrollModal() {
            if (window.enrollmentManager) {
                window.enrollmentManager.openEnrollModal();
            }
        }

        function closeEnrollModal() {
            if (window.enrollmentManager) {
                window.enrollmentManager.closeEnrollModal();
            }
        }

        // Initialize Page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize enrollment manager
            window.enrollmentManager = new EnrollmentManager();

            // Table selection
            const selectAllCheckbox = document.getElementById('selectAll');
            const rowCheckboxes = document.querySelectorAll('.row-checkbox');

            if (selectAllCheckbox) {
                selectAllCheckbox.addEventListener('change', function() {
                    rowCheckboxes.forEach(checkbox => {
                        checkbox.checked = this.checked;
                    });
                });
            }

            // Modal background click
            const modal = document.getElementById('enrollModal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeEnrollModal();
                    }
                });
            }

            console.log('Enrollments Management System initialized');
        });
    </script>
</body>
</html>
